<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Dashboard - Luxibre Alpha</title>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@3.4.1/dist/tailwind.min.css" rel="stylesheet">
</head>
<body class="bg-gray-900 text-white">

  <header class="p-6 flex justify-between items-center bg-gray-800 shadow-md">
    <h1 class="text-2xl font-bold">Luxibre Alpha</h1>
    <button id="logoutBtn" class="bg-red-500 hover:bg-red-600 px-4 py-2 rounded">Déconnexion</button>
  </header>

  <main class="p-6">
    <h2 class="text-3xl font-bold mb-6">Signaux du jour</h2>
    <div id="signals" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
      <!-- Cartes signaux -->
    </div>
  </main>

  <script src="https://identity.netlify.com/v1/netlify-identity-widget.js"></script>
  <script src="/js/auth-check.js"></script>
  <script src="/js/dashboard.js"></script>
  <script>
  async function checkUserRole() {
    const userEmail = localStorage.getItem("userEmail");
    if (!userEmail) return;

    const res = await fetch(`/.netlify/functions/get-role?email=${userEmail}`);
    const data = await res.json();

    if (data.role !== "premium") {
      document.querySelectorAll(".premium").forEach(el => {
        el.classList.add("blur-sm", "pointer-events-none");
      });
      const message = document.createElement("div");
      message.innerHTML = `
        <div class="text-center bg-yellow-200 text-yellow-800 p-3 rounded mt-4">
          Ce contenu est réservé aux membres Premium.
          <a href="/pricing.html" class="underline ml-2">Passer à Premium</a>
        </div>`;
      document.querySelector("#signals-container").appendChild(message);
    }
  }

  checkUserRole();
</script>

</body>
</html>
